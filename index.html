<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Welcome to Hell</title>
</head>
<body>
<body>
    <!-- App -->
    <div class="app">
        <ul class="messages"></ul>
        <input type="text" disabled class="messageInput" placeholder="Enter your message here" />
    </div>

    <!-- Scripts -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="/socket.io/socket.js"></script>
    <script>
        // IO
        var socket = io.connect(document.location.protocol+'//'+document.location.host);

        // Ready
        $(function(){
            // Fetch
            var $app = $('.app');
            var $messages = $app.find('.messages');
            var $messageInput = $app.find('.messageInput').removeAttr('disabled').focus();

            // Receive Message
            socket.on('message', function(message){
                console.log('received message:', message);
                $message = $('<li>',{
                    'class': 'message',
                    text: message.text
                });
                $messages.append($message);
            });

            // Send Message
            $messageInput.on('keypress', function(event){
                if ( event.keyCode === 13 ) { // enter
                    var message = {
                        text: $messageInput.val().trim()
                    };
                    console.log('send message:', message);
                    socket.emit('message',message);
                    $messageInput.val(''); // clear input
                }
            });
        });
    </script>
</body>
</html>
