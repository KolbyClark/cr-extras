<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Welcome to Hell</title>
  <style>
    .server-message{
	  color: red;
	}
  </style>
</head>
<body>
<body>
    <!-- App -->
    <div class="app">
        <ul class="messages"></ul>
        <input type="text" class="messageInput" placeholder="Enter your message here" /><br />
		<input type="button" class="create">Create Room</button><br />
		<input type="button" class="join">Join Room</button>
    </div>

    <!-- Scripts -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="//cdn.socket.io/socket.io-1.3.5.js"></script>
    <script>
        // IO
        var socket = io.connect(document.location.protocol+'//'+document.location.host);

        // Ready
        $(function(){
            // Fetch
            var $app = $('.app');
            var $messages = $app.find('.messages');
            var $messageInput = $app.find('.messageInput').removeAttr('disabled').focus();

            // Receive Message
            socket.on('message', function(message){
                console.log('received message:', message);
                $message = $('<li>',{
                    'class': 'message',
                    text: message.text
                });
                $messages.append($message);
            });
			socket.on('smessage', function(message){
			  console.log('received a sever message:',message);
			  $message = $('<li>',{'class': ['message','sever-message'],text: message.msg});
			  $messages.append($message);
			});

            // Send Message
            $messageInput.on('keypress', function(event){
                if ( event.keyCode === 13 ) { // enter
                    var message = {
                        text: $messageInput.val().trim()
                    };
                    console.log('send message:', message);
                    socket.emit('message',message);
                    $messageInput.val(''); // clear input
                }
            });
			$('.create').click(function(){
			  socket.emit('createRoom',{name:$messageInput.val().trim()});
			  $messageInput.val('');
			});
			$('.join').click(function(){
			  socket.emit('joinRoom',{name:$messageInput.val().trim()});
			  $messageInput.val('');
			});
        });
    </script>
</body>
</html>
